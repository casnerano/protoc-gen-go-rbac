// Code generated by protoc-gen-go-rbac. DO NOT EDIT.
// versions:
// - protoc-gen-go-grpc {{ .Meta.ModuleVersion }}
// - protoc             {{ .Meta.ProtocVersion }}
// source: {{ .File.Source }}

package {{ .File.Package }}

import (
    "github.com/casnerano/protoc-gen-go-rbac/pkg/rbac"
    desc "github.com/casnerano/protoc-gen-go-rbac/proto"
)

{{- range .Services }}
    var rbac{{ .Name }} = rbac.Service{
        {{- if .Rules }}
            Rules: &rbac.Rules{
                AccessLevel: desc.AccessLevel_{{ .Rules.AccessLevel }},
                {{- if .Rules.AllowedRoles }}
                AllowedRoles: []string{
                    {{- range $i, $role := .Rules.AllowedRoles }}
                    "{{ $role | toLower }}",
                    {{- end }}
                },
                {{- end }}
            },
        {{- else }}
            Rules: nil,
        {{- end }}
        Methods: map[string]rbac.Method{
            {{- range .Methods }}
            "{{ .Name }}": {
                Rules: &rbac.Rules{
                    AccessLevel: desc.AccessLevel_{{ .Rules.AccessLevel }},
                    {{- if .Rules.AllowedRoles }}
                    AllowedRoles: []string{
                        {{- range $j, $role := .Rules.AllowedRoles }}
                        "{{ $role | toLower }}",
                        {{- end }}
                    },
                    {{- end }}
                },
            },
            {{- end }}
        },
    }

    func (Unimplemented{{ .Name }}Server) CheckAccess(fullMethod string, roles []string) bool {
        return rbac.CheckAccess(&rbac{{ .Name }}, fullMethod, roles)
    }
{{- end }}

